<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>RiderTrack - Tracking</title>
    <!-- Bootstrap core CSS-->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom fonts for this template-->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- Page level plugin CSS-->
    <link href="vendor/datatables/dataTables.bootstrap4.css" rel="stylesheet">
    <!-- Custom styles for this template-->
    <link href="css/sb-admin.css" rel="stylesheet">

    <!-- Leaflet CSS file -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
          integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
          crossorigin=""/>
    <style>
        * {
            box-sizing: border-box;
        }

        div.container {
            width: 100%;
            height: "wrap-content";
            background:white;
            margin: auto;
            padding: 10px;
        }

        body {
            margin: 2;
        }

        .header {
            min-height:200px;
            width:100%;
        }

        /* Create two columns that floats next to each other */
        .column {
            float: left;
            padding: 10px;
            height: "wrap-content";
        }

        .left {
            width: 25%;
        }

        .right {
            width: 75%;
        }

        /* Clear floats after the columns */
        .row:after {
            content: "";
            display: table;
            clear: both;
        }

        ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        li {
            font: 150 18px/1.5 Helvetica, Verdana, sans-serif;
            border-bottom: 1px solid #ccc;
        }

        li:last-child {
            border: none;
        }

        li a {
            text-decoration: none;
            color: #000;
            display: block;
            width: 200px;

            -webkit-transition: font-size 0.3s ease, background-color 0.3s ease;
            -moz-transition: font-size 0.3s ease, background-color 0.3s ease;
            -o-transition: font-size 0.3s ease, background-color 0.3s ease;
            -ms-transition: font-size 0.3s ease, background-color 0.3s ease;
            transition: font-size 0.3s ease, background-color 0.3s ease;
        }

        li a:hover {
            font-size: 20px;
            background: #f6f6f6;
        }

        input[type=text] {
            width: 130px;
            box-sizing: border-box;
            border: 2px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            background-color: white;
            background-image: url('search.png');
            background-position: 10px 10px;
            background-repeat: no-repeat;
            padding: 10px 10px 10px 35px;
            -webkit-transition: width 0.4s ease-in-out;
            transition: width 0.4s ease-in-out;
        }

        input[type=text]:focus {
            width: 100%;
        }

        /* Responsive layout - makes the two columns stack on top of each other instead of next to each other */
        @media (max-width: 600px) {
            .column {
                width: 100%;
            }
        }
    </style>


</head>
<body id="page-top">
<div class="container-fluid" style="border: 1px solid white;width:100%; height:100%; margin-top:10px">
    <div class="breadcrumb header">
        <h2>Event Name</h2>
    </div>
    <div class="row">
        <div class="column left">
            <!-- <div class="breadcrumb" style="border: 1px solid gray;width:100%; height:100%;"></div>-->
            <div class="card mb-3" style="height:630px">
                <div class="card-header">
                    <i class="fa fa-area-chart"></i>Track Participants
                    <!--<i class="fa fa-search"></i>-->
                </div>
                <div class="card-body">
                    <form>
                        <input type="text" name="search" placeholder="Search..">
                    </form>
                    <br/>
                    <ul>
                        <li><a href="#">Rider 1</a></li>
                        <li><a href="#">Rider 2</a></li>
                        <li><a href="#">Rider 3</a></li>
                        <li><a href="#">Rider 4</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="column right">
            <!-- Make sure you put this AFTER Leaflet's CSS -->
            <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
                    integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
                    crossorigin=""></script>

            <div class="card mb-3">
                <div class="card-header">
                    <i class="fa fa-area-chart"></i> Track Location
                </div>
                <div class="card-body">
                    <div id="map" style="width:100%; height:500px; padding:0%"></div>
                    <script>
                        var mymap = L.map('map').setView([33.42192543,-111.92350757], 13);
                        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
                            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
                            maxZoom: 18,
                            id: 'mapbox.streets',
                            accessToken: 'pk.eyJ1IjoiaGltYW5pMzEzIiwiYSI6ImNqY3V3ZjBvdjBlbjQycW11eDdyem11dnMifQ.yqjbj4rbuYIByGQ9EXn2IA'
                        }).addTo(mymap);

                        //var marker = L.marker([51.5, -0.09]).addTo(mymap);
                        //marker.bindPopup("<b>Rider 1</b><br>I am here.").openPopup();


                        //Make API connection using Ajax

                        var request = new XMLHttpRequest();
                        request.open('GET', "https://savemyloc.herokuapp.com/users/Buffalo", true);
                        request.send();

                        request.onreadystatechange =
                            function() { getData(request) };

                        function getData(request) {
                            if ((request.readyState == 4) && (request.status == 200)) {
                                var jsonDocument = JSON.parse(request.responseText);
                                console.log(jsonDocument[0]);
                                console.log(jsonDocument[0].lat);
                                //var marker = L.marker([jsonDocument[0].lat, jsonDocument[0].lng]).addTo(mymap);
                                var latlngs = [];
                                for(var i=0; i<jsonDocument.length; i++){
                                    latlngs.push([jsonDocument[i].lat, jsonDocument[i].lng]);
                                }
                                /*var latlngs = [
                                  [jsonDocument[0].lat, jsonDocument[0].lng],
                                  [jsonDocument[1].lat, jsonDocument[1].lng],
                                  [jsonDocument[2].lat, jsonDocument[2].lng]
                                ];*/
                                var polyline = L.polyline(latlngs, {color: 'red'}).addTo(mymap);
                                // zoom the map to the polyline
                                mymap.fitBounds(polyline.getBounds());
                            }
                        }
                    </script>
                </div>
                <div class="card-footer small text-muted">Updated yesterday at 11:59 PM</div>
            </div>
        </div>
    </div>
</div>
<!-- Bootstrap core JavaScript-->
<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- Core plugin JavaScript-->
<script src="vendor/jquery-easing/jquery.easing.min.js"></script>
<!-- Page level plugin JavaScript-->
<script src="vendor/chart.js/Chart.min.js"></script>
<script src="vendor/datatables/jquery.dataTables.js"></script>
<script src="vendor/datatables/dataTables.bootstrap4.js"></script>
<!-- Custom scripts for all pages-->
<script src="js/sb-admin.min.js"></script>
<!-- Custom scripts for this page-->
<script src="js/sb-admin-datatables.min.js"></script>
<script src="js/sb-admin-charts.min.js"></script>
</body>
</html>
